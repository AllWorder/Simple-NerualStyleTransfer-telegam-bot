# Simple-NerualStyleTransfer-telegam-bot

## Описание
Телеграм-бот, который переносит стиль одного изображения на другое. Данный бот выполнен для итогового проекта DLS.

За основу модели был взят код из [видео](https://www.youtube.com/watch?v=u2HDm7YSwoA) и идея из [статьи](https://arxiv.org/pdf/1508.06576.pdf).
## Требования
- Python 3
- библиотека PyTorch для Python 3
- библиотека telebot для Python 3
## Установка
1) Склонировать репозиторий
2) В telegram_bot.py вставить свой токен бота в **TELEGRAM_TOKEN**
3) Настроить гиперпараметры в **telegram_bot.py** (можно оставить по умолчанию)
4) Запустить в терминале `python3 telegram_bot.py`
## Гиперпараметры
В файле **telegram_bot.py** содержатся гиперпараметры для переноса стиля:
- **IMAGE_SIZE** - определяет размер картинки, которая попадёт в нейросеть. Т.е. при отправки пользователем картинки большего размера, программа обрежет её до квадрата со сторонами IMAGE_SIZE x IMAGE_SIGE. Для работе на CPU рекомендуется использовать не более 256.
- **ITERATION_LIMIT** - определяет максимальное число циклов обучения для переноса стиля. Для работе на CPU рекомендуется использовать не более 200.
- **STYLE_WEIGHT** - определяет множитель перед style loss в функции потерь. Чем выше данный параметр, тем больший фокус на стиль будет при обучении. Модель начинает заметно переносить стиль при параметре в 10000, рекомендуется использовать в пределах 100000-10000000.
- **CONTENT_WEIGHT** - определяет множитель перед content loss в функции потерь. Обычно нет проблем с сохранением содержания картинки, поэтому данный параметр должен быть много меньше **STYLE_WEIGHT**
## Структура кода
- **utils.py** содержит вспомогательные инструменты для картинок
- **StyleTransferNN.py** содержит саму модель нейронной сети и функции для переноса стиля
- **telegram_bot.py** содержит гиперпараметры, запуск бота и определение его взаимодействия с пользователем
## Взаимодействие с пользователем
Для начала работы пользователь должен отправить боту команду `/start`. После этого бот попросит пользователя прислать изображение с контентом, после чего отправить изображение со стилем. Важно отправлять изображения как фото, а не как файл без сжатия, иначе бот не поймёт.


![example5](https://user-images.githubusercontent.com/55362352/215346542-ffeb3214-143e-445e-8a70-d2161bc72019.jpg)
## Примеры работы
Для тестирования будем использовать как контентное изображение лабораторный корпус МФТИ:
![small_lk](https://user-images.githubusercontent.com/55362352/215344667-959bbc97-db93-4add-9a55-fcf952619afb.jpg)
### Пример 1. Звёздная ночь
![example1](https://user-images.githubusercontent.com/55362352/215344875-bb7406f2-a90b-434b-8f9c-ed0f07c44a57.jpg)
### Пример 2. Крик
![example2](https://user-images.githubusercontent.com/55362352/215345003-3f3a99b5-dd08-476b-ad7a-d65d4e4d2aaa.jpg)
### Пример 3. Femme nue assise
![example3](https://user-images.githubusercontent.com/55362352/215345249-cf554288-24d6-4756-9803-e2ce07dbe2e4.jpg)
Влияние параметра **STYLE_WEIGHT** на результат:
![example4](https://user-images.githubusercontent.com/55362352/215345528-0111def3-e415-4a0a-9ff9-685f96b8eb5b.jpg)





